' Gambas class file

'Private shellProc As Process 
Public Git_sOutput As String = ""
Public MSG_No_Git_Project_Selected As String = "Please get a Git project directory."
Public MSG_No_SelectedPath_FileChooser1 As String = "Please select a file or directory."

Public Sub _new()
  
End

Public Sub Form_Open()
  
  FMain.Center
  
End

Public Sub Button_Get_Project_Directory_Click()
  
  Dialog.Title = "Select Project Directory"
  Dialog.Path = "/home/infektedpc/Projects/testjunkrep" 'REMOVE ME
  Dialog.ShowHidden = True
  
  If Dialog.SelectDirectory() Then Return
  TextBox_Project_Directory.Text = Dialog.Path
  FileChooser1.Root = Dialog.Path
  CheckBox_Show_Hidden_Dirs.Enabled = True
  FileChooser1.Enabled = True
  
End

Public Sub Button_Commit_Click()
  
  If Not TextBox_Project_Directory.Text = "" Then
    If TextBox_Comment.Text = "" Then
      Message.Info("Please fill out comment")
    Else
      Git_sOutput = ""
      Shell "cd " & TextBox_Project_Directory.Text & ";git commit -m " & "'" & TextBox_Comment.Text & "'" To Git_sOutput
      TextBox_Comment.Clear
      If Not Git_sOutput = "" Then
        TextArea_Log.Text = TextArea_Log.text & "Commit: " & Git_sOutput
        Message.Info(Git_sOutput)
      End If
    End If
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If
  
End

Public Sub Button_Push_Click()
  
  Shell "cd " & TextBox_Project_Directory.Text & ";xterm -hold -e git push" '"xdg-open "
  
End

Public Sub Button_Add_Click()
  
  If Not TextBox_Project_Directory.Text = "" Then
    Git_sOutput = ""
    Shell "cd " & TextBox_Project_Directory.Text & ";git add ." To Git_sOutput
    If Not Git_sOutput = "" Then
      TextArea_Log.Text = TextArea_Log.text & "Add: " & Git_sOutput
      Message.Info(Git_sOutput)
    End If
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If
  
End

Public Sub Button_Pull_Click()
  
  If Not TextBox_Project_Directory.Text = "" Then
    Git_sOutput = ""
    Shell "cd " & TextBox_Project_Directory.Text & ";git pull" To Git_sOutput
    If Not Git_sOutput = "" Then
      TextArea_Log.text = TextArea_Log.text & "Pull: " & Git_sOutput
      Message.Info(Git_sOutput)
    End If
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If
  
End

Public Sub Button_Clear_Log_Click()
  
  TextArea_Log.Clear
  
End

Public Sub CheckBox_Show_Hidden_Dirs_Click()
  
  If CheckBox_Show_Hidden_Dirs.Value = True Then
    FileChooser1.ShowHidden = True
  Else
    FileChooser1.ShowHidden = False
  Endif
  
End

Public Sub Button_Add_File_Click()
  
End

Public Sub Button_Remove_Click()
  
  If Not TextBox_Project_Directory.Text = "" Then
    If Not FileChooser1.SelectedPath = "" Then
      Git_sOutput = ""
      Shell "cd " & TextBox_Project_Directory.Text & ";git rm " & Chr(34) & FileChooser1.SelectedPath & Chr(34) To Git_sOutput
      FileChooser1.Reload
      If Not Git_sOutput = "" Then
        Message.Info(Git_sOutput)
      End If
    Else
      Message.Info(MSG_No_SelectedPath_FileChooser1)
    End If
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If
  
End

Public Sub Button_Move_Click()
  
  If Not TextBox_Project_Directory.Text = "" Then
    If Not FileChooser1.SelectedPath = "" Then
      Dialog.Title = "Move To Directory"
      Dialog.Path = TextBox_Project_Directory.Text
      If Dialog.SelectDirectory() Then Return
      Git_sOutput = ""
      Shell "cd " & TextBox_Project_Directory.Text & ";git mv " & Chr(34) & FileChooser1.SelectedPath & Chr(34) & " " & Chr(34) & Dialog.Path & "/" & File.Name(FileChooser1.SelectedPath) & Chr(34) To Git_sOutput
      FMain.FileChooser1.Reload
      If Not Git_sOutput = "" Then
        Message.Info(Git_sOutput)
      Endif
    Else
      Message.Info(MSG_No_SelectedPath_FileChooser1)
    End If
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If
  
End

Public Sub Button_Rename_Click()
  
  If Not FMain.TextBox_Project_Directory.Text = "" Then
    If Not FileChooser1.SelectedPath = "" Then
      FRenaming.ShowDialog
    Else
      Message.Info(MSG_No_SelectedPath_FileChooser1)
    End If
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  Endif
  
End

Public Sub Button_Commit_Log_Click()
  
  If Not TextBox_Project_Directory.Text = "" Then
    FCommit_Log.ShowDialog
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If
  
End

Public Sub Button_View_Diff_Click()

  If Not TextBox_Project_Directory.Text = "" Then
    Shell "cd " & TextBox_Project_Directory.Text & ";git difftool -y -t meld " & FileChooser1.SelectedPath
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If

End

Public Sub File_Clone_Click()
  
  FClone.Show
  
End

Public Sub File_Checkout_Click()
  
  FCheckout.Show
  
End

Public Sub File_Close_Click()
  
  FMain.Close
  
End

Public Sub View_Commit_Log_Click()
  
  If Not TextBox_Project_Directory.Text = "" Then
    FCommit_Log.Show
  Else
    Message.Info(MSG_No_Git_Project_Selected)
  End If
  
End

Public Sub File_Init_Click()
  
  FInit.Show
  
End

Public Sub File_Login_Click()

  FLogin.Show

End

Public Sub Help_About_Click()

  FAbout.Show

End

Public Sub Options_Log_Style_Click()

  FlogStyle.Show

End

Public Sub Help_Help_Click()

  FHelp.Show

End
